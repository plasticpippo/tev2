# NPM Package Upgrade Research Report

**Research Date:** 2026-02-11  
**Research Tool:** Context7 MCP, npm audit  
**Purpose:** Document safe upgrade paths for vulnerable npm packages

---

## Executive Summary

This report documents the research findings for upgrading vulnerable npm packages in both backend and frontend. The packages are categorized by risk level based on the complexity of the upgrade path.

| Risk Level | Packages | Action Required |
|------------|----------|-----------------|
| **LOW** | axios, express, qs, glob, jws | Simple version bump, no code changes |
| **MEDIUM** | js-yaml, esbuild | Version bump with potential config changes |
| **HIGH** | vitest ecosystem | Major version upgrade with breaking changes |

---

## Backend Packages

### 1. axios

| Attribute | Value |
|-----------|-------|
| **Current Version** | 1.13.3 |
| **Vulnerable Range** | <=1.13.4 |
| **Minimum Secure Version** | >1.13.4 (latest: 1.x) |
| **GHSA ID** | GHSA-43fc-jf86-j433 |
| **Severity** | High |
| **Risk Level** | LOW |

#### Vulnerability Details
- **Title:** DoS via `__proto__` Key in mergeConfig
- **CWE:** CWE-754 (Improper Check for Unusual or Exceptional Conditions)
- **CVSS Score:** 7.5 (High)
- **Description:** Axios is vulnerable to Denial of Service when processing untrusted input in the `mergeConfig` function where the `__proto__` property key can be exploited.

#### Breaking Changes
**None expected.** This is a patch version upgrade (1.13.3 → 1.13.5+) with only security fixes.

#### Migration Steps
```bash
cd backend
npm install axios@latest
```

#### Code Changes Required
**None.** The API remains unchanged.

#### Verification
```bash
npm audit
npm test
```

---

### 2. express

| Attribute | Value |
|-----------|-------|
| **Current Version** | 4.18.2 (package.json shows ^4.18.2) |
| **Installed Version** | 4.21.2 (from audit) |
| **Vulnerable Range** | 4.0.0-rc1 - 4.21.2 |
| **Minimum Secure Version** | >4.21.2 |
| **GHSA ID** | GHSA-6rw7-vpxm-498p (via qs) |
| **Severity** | High |
| **Risk Level** | LOW |

#### Vulnerability Details
- **Title:** Inherited vulnerability via qs and body-parser dependencies
- **Description:** Express is vulnerable due to its dependencies on `qs` and `body-parser`, both affected by the qs arrayLimit bypass vulnerability.

#### Dependency Chain
```
express@4.21.2
├── body-parser@1.20.3
│   └── qs@6.13.0 (vulnerable)
└── qs@6.13.0 (vulnerable)
```

#### Breaking Changes
**None expected.** This is a patch version upgrade (4.21.2 → 4.22+) with only dependency updates.

#### Migration Steps
```bash
cd backend
npm install express@latest
```

Or simply run:
```bash
npm audit fix
```

#### Code Changes Required
**None.** The Express 4.x API remains stable.

#### Verification
```bash
npm audit
npm test
npm run dev
```

---

### 3. qs

| Attribute | Value |
|-----------|-------|
| **Current Version** | 6.13.0 / 6.14.0 |
| **Vulnerable Range** | <6.14.1 |
| **Minimum Secure Version** | >=6.14.1 |
| **GHSA ID** | GHSA-6rw7-vpxm-498p |
| **Severity** | High |
| **Risk Level** | LOW |
| **Direct Dependency** | No (transitive) |

#### Vulnerability Details
- **Title:** arrayLimit bypass in bracket notation allows DoS via memory exhaustion
- **CWE:** CWE-20 (Improper Input Validation)
- **CVSS Score:** 7.5 (High)

#### Breaking Changes
**None expected.** This is a patch version upgrade.

#### Migration Steps
This is a transitive dependency. It will be automatically updated when updating express:

```bash
cd backend
npm audit fix
```

Or manually override:
```bash
npm install qs@latest
```

#### Code Changes Required
**None.** This is a transitive dependency with no API changes.

---

### 4. js-yaml

| Attribute | Value |
|-----------|-------|
| **Current Version** | 3.14.1 |
| **Vulnerable Range** | <3.14.2 |
| **Minimum Secure Version** | >=3.14.2 (patch) or >=4.0.0 (major) |
| **GHSA ID** | GHSA-mh29-5h37-fv8m |
| **Severity** | Moderate |
| **Risk Level** | LOW (patch) / MEDIUM (major) |
| **Direct Dependency** | No (transitive) |

#### Vulnerability Details
- **Title:** Prototype pollution in merge (<<)
- **CWE:** CWE-1321 (Improperly Controlled Modification of Object Prototype Attributes)
- **CVSS Score:** 5.3 (Moderate)

#### Upgrade Options

**Option A: Patch Upgrade (Recommended)**
- Update to 3.14.2+ for security fix without breaking changes
- Risk: LOW

**Option B: Major Upgrade to 4.x**
- More comprehensive security improvements
- Risk: MEDIUM due to breaking changes

#### Breaking Changes (if upgrading to 4.x)

| v3 API | v4 API |
|--------|--------|
| `yaml.safeLoad(str)` | `yaml.load(str)` |
| `yaml.safeLoadAll(str)` | `yaml.loadAll(str)` |
| `yaml.safeDump(obj)` | `yaml.dump(obj)` |
| `yaml.DEFAULT_SAFE_SCHEMA` | `yaml.DEFAULT_SCHEMA` |
| `yaml.DEFAULT_FULL_SCHEMA` | `yaml.DEFAULT_SCHEMA.extend(require('js-yaml-js-types').all)` |
| `yaml.Schema.create(...)` | `yaml.DEFAULT_SCHEMA.extend([...])` |

#### Migration Steps

**Option A (Patch - Recommended):**
```bash
cd backend
npm audit fix
```

**Option B (Major - if direct usage):**
```bash
npm install js-yaml@latest
```

Then update code:
```javascript
// Before (v3)
const data = yaml.safeLoad(str);

// After (v4)
const data = yaml.load(str);
```

#### Code Changes Required
**None for patch upgrade.** For major upgrade, update any direct usage of the API.

---

## Frontend Packages

### 1. glob

| Attribute | Value |
|-----------|-------|
| **Current Version** | 10.2.0 - 10.4.5 |
| **Vulnerable Range** | 10.2.0 - 10.4.5 |
| **Minimum Secure Version** | >=10.5.0 |
| **GHSA ID** | GHSA-5j98-mcp5-4vw2 |
| **Severity** | High |
| **Risk Level** | LOW |
| **Direct Dependency** | No (transitive) |

#### Vulnerability Details
- **Title:** CLI Command injection via -c/--cmd executes matches with shell:true
- **CWE:** CWE-78 (OS Command Injection)
- **CVSS Score:** 7.5 (High)
- **Description:** The glob package CLI has a command injection vulnerability when using `-c` or `--cmd` flags.

#### Breaking Changes
**None expected.** This is a minor version upgrade (10.4.x → 10.5.0+).

#### Migration Steps
```bash
cd frontend
npm audit fix
```

#### Code Changes Required
**None.** This is a transitive dependency with no API changes.

#### Production Impact
**Low.** This vulnerability only affects CLI usage, not programmatic API usage.

---

### 2. jws

| Attribute | Value |
|-----------|-------|
| **Current Version** | 4.0.0 |
| **Vulnerable Range** | 4.0.0 (exact version) |
| **Minimum Secure Version** | !=4.0.0 (any other version) |
| **GHSA ID** | GHSA-869p-cjfg-cm3x |
| **Severity** | High |
| **Risk Level** | LOW |
| **Direct Dependency** | No (transitive) |

#### Vulnerability Details
- **Title:** Improperly Verifies HMAC Signature
- **CWE:** CWE-347 (Improper Verification of Cryptographic Signature)
- **CVSS Score:** 7.5 (High)
- **Description:** jws version 4.0.0 improperly verifies HMAC signatures, potentially allowing token forgery.

#### Breaking Changes
**None expected.** Moving to 4.0.1+ or another version is a patch-level change.

#### Migration Steps
```bash
cd frontend
npm audit fix
```

#### Code Changes Required
**None.** This is a transitive dependency.

#### Production Impact
**Medium.** If JWT tokens are used in the frontend, this could be a security concern.

---

### 3. esbuild

| Attribute | Value |
|-----------|-------|
| **Current Version** | <=0.24.2 |
| **Vulnerable Range** | <=0.24.2 |
| **Minimum Secure Version** | >0.24.2 (0.25.0+) |
| **GHSA ID** | GHSA-67mh-4wv8-2f99 |
| **Severity** | Moderate |
| **Risk Level** | MEDIUM |
| **Direct Dependency** | No (via vite/vitest) |

#### Vulnerability Details
- **Title:** Dev server enables any website to send requests and read responses
- **CWE:** CWE-346 (Origin Validation Error)
- **CVSS Score:** 5.3 (Moderate)
- **Description:** esbuild's development server allows any website to send requests and read responses, potentially exposing source code if a developer visits a malicious website while the dev server is running.

#### Breaking Changes
esbuild uses 0.x versioning where minor versions can contain breaking changes. Key considerations:

- Version 0.24.0 was marked as "deliberately contains backwards-incompatible changes"
- Version 0.25.0+ may have additional changes
- Most changes affect build configurations, not runtime

#### Migration Steps
This will be updated automatically when updating vitest:

```bash
cd frontend
npm audit fix --force
```

Or update vitest which will bring in updated esbuild:

```bash
npm install vitest@latest @vitest/coverage-v8@latest @vitest/ui@latest
```

#### Code Changes Required
**Likely none.** esbuild is used internally by Vite. Review build output after upgrade.

#### Production Impact
**Low.** This is a development-time vulnerability only.

---

### 4. vite

| Attribute | Value |
|-----------|-------|
| **Current Version** | 6.2.0 (from package.json) |
| **Vulnerable Range** | 0.11.0 - 6.1.6 |
| **Minimum Secure Version** | >6.1.6 |
| **GHSA ID** | Inherited from esbuild |
| **Severity** | Moderate |
| **Risk Level** | LOW |
| **Direct Dependency** | Yes |

#### Vulnerability Details
- **Title:** Inherited from esbuild dependency
- **Description:** vite is affected through its dependency on vulnerable esbuild versions.

#### Current Status
**IMPORTANT:** The current package.json shows vite@^6.2.0, which is already above the vulnerable range (6.1.6). However, the npm audit may be detecting the vulnerability due to:
1. Lock file containing older resolved versions
2. Transitive dependencies pulling older versions

#### Breaking Changes
Vite 6.x to 7.x/8.x has some changes:
- `esbuild` option deprecated in favor of `oxc` option
- `resolve.conditions` default value changed
- JSON stringify behavior updated
- Sass now uses modern API by default

#### Migration Steps
First, verify current installed version:
```bash
cd frontend
npm list vite
```

If already on 6.2.0+, the vulnerability may be from transitive deps. Run:
```bash
npm audit fix
```

If upgrade needed:
```bash
npm install vite@latest
```

#### Code Changes Required
Review [`frontend/vite.config.ts`](frontend/vite.config.ts) after upgrade. The current configuration uses standard options that should remain compatible.

#### Verification
```bash
npm run dev
npm run build
npm test
```

---

### 5. vitest (and related packages)

| Attribute | Value |
|-----------|-------|
| **Current Version** | ^1.0.0 |
| **Vulnerable Range** | Multiple ranges (see below) |
| **Minimum Secure Version** | 4.0.18 |
| **GHSA ID** | Inherited from vite/esbuild |
| **Severity** | Moderate |
| **Risk Level** | HIGH |
| **Direct Dependency** | Yes |

#### Related Packages
- `@vitest/coverage-v8`: ^1.0.0 → 4.0.18
- `@vitest/ui`: ^1.0.0 → 4.0.18

#### Vulnerability Details
- **Title:** Inherited from multiple dependencies (vite, vite-node, esbuild)
- **Description:** vitest is affected through dependency chains involving vite and esbuild.

#### Breaking Changes (1.x → 4.x)

This is a **major version upgrade** with significant breaking changes:

##### 1. Coverage Configuration Changes
```typescript
// Before (v1.x)
export default defineConfig({
  test: {
    coverage: {
      all: true,
      extensions: ['js', 'ts']
    }
  }
})

// After (v4.x)
export default defineConfig({
  test: {
    coverage: {
      include: ['packages/**/src/**.{js,jsx,ts,tsx}'],
      exclude: ['**/some-pattern/**']
      // 'all' and 'extensions' removed
    }
  }
})
```

##### 2. Test Function Options Order Changed
```typescript
// Before (v1.x)
test('example', () => { /* ... */ }, { retry: 2 })

// After (v4.x)
test('example', { retry: 2 }, () => { /* ... */ })
```

##### 3. Exclude Patterns Changed
```typescript
// To restore previous exclude behavior in v4.x:
import { configDefaults, defineConfig } from 'vitest/config'

export default defineConfig({
  test: {
    exclude: [
      ...configDefaults.exclude,
      '**/dist/**',
      '**/cypress/**',
      '**/.{idea,git,cache,output,temp}/**',
      '**/{karma,rollup,webpack,vite,vitest,jest,ava,babel,nyc,cypress,tsup,build,eslint,prettier}.config.*'
    ]
  }
})
```

##### 4. Pool Options Migrated to Top-Level
```typescript
// Before (v1.x)
export default defineConfig({
  test: {
    poolOptions: {
      forks: {
        execArgv: ['--expose-gc'],
        isolate: false,
        singleFork: true,
      },
      vmThreads: {
        memoryLimit: '300Mb'
      },
    },
  }
})

// After (v4.x)
export default defineConfig({
  test: {
    execArgv: ['--expose-gc'],
    isolate: false,
    maxWorkers: 1,
    vmMemoryLimit: '300Mb',
  }
})
```

##### 5. V8 Coverage Provider Changes
- Uses new AST-based remapping logic
- More accurate coverage reports
- `coverage.ignoreEmptyLines` removed (now default behavior)
- `coverage.experimentalAstAwareRemapping` removed (now default)

#### Migration Steps

**Step 1: Update packages**
```bash
cd frontend
npm install vitest@latest @vitest/coverage-v8@latest @vitest/ui@latest
```

**Step 2: Update vitest.config.ts**

Current config at [`frontend/vitest.config.ts`](frontend/vitest.config.ts):
```typescript
import { defineConfig } from 'vitest/config';

export default defineConfig({
 test: {
   environment: 'jsdom',
   setupFiles: ['./src/test/setup.ts'],
   globals: true,
   css: true,
   reporters: ['verbose'],
   coverage: {
     provider: 'v8',
     reporter: ['text', 'json', 'html'],
     exclude: [
       'node_modules',
       'src/test',
       'src/mocks',
       'vite.config.ts',
       'vitest.config.ts'
     ]
   }
 },
 resolve: {
   alias: {
     '@': '/src',
   },
 },
});
```

**Updated config for v4.x:**
```typescript
import { defineConfig, configDefaults } from 'vitest/config';

export default defineConfig({
 test: {
   environment: 'jsdom',
   setupFiles: ['./src/test/setup.ts'],
   globals: true,
   css: true,
   reporters: ['verbose'],
   coverage: {
     provider: 'v8',
     reporter: ['text', 'json', 'html'],
     include: ['src/**/*.{js,jsx,ts,tsx}'],
     exclude: [
       'src/test',
       'src/mocks',
     ]
   }
 },
 resolve: {
   alias: {
     '@': '/src',
   },
 },
});
```

**Step 3: Run tests**
```bash
npm test
```

**Step 4: Verify coverage still works**
```bash
npm run test:coverage
```

#### Code Changes Required
1. Update [`frontend/vitest.config.ts`](frontend/vitest.config.ts) with new coverage configuration
2. Review any test files using options as third argument to `test()` or `describe()`
3. Review any custom pool options

#### Production Impact
**None.** This is a development dependency only.

---

## Upgrade Order Recommendations

### Phase 1: Low Risk Updates (Immediate)

These updates have minimal risk and can be applied immediately:

```bash
# Backend
cd backend
npm audit fix

# Frontend
cd frontend
npm audit fix
```

This will fix:
- axios (backend)
- express (backend)
- qs (backend)
- js-yaml (backend) - patch version
- glob (frontend)
- jws (frontend)

### Phase 2: Medium Risk Updates (After Testing)

These updates require verification but are relatively safe:

```bash
# Frontend - verify vite version first
cd frontend
npm list vite
# If vite is already 6.2.0+, no action needed
# If not, run:
npm install vite@latest
npm run dev
npm run build
npm test
```

### Phase 3: High Risk Updates (Careful Planning Required)

The vitest ecosystem upgrade requires careful planning:

1. **Create a branch** for the upgrade
2. **Update vitest packages**
3. **Update vitest.config.ts** with new configuration
4. **Run all tests** and fix any issues
5. **Verify coverage** still works correctly
6. **Code review** before merging

---

## Risk Assessment Summary

### Backend Packages

| Package | Upgrade Risk | Production Impact | Testing Required |
|---------|-------------|-------------------|------------------|
| axios | LOW | Medium (DoS) | Standard |
| express | LOW | Medium (DoS) | Standard |
| qs | LOW | Medium (DoS) | Standard |
| js-yaml | LOW/MEDIUM | Low (prototype pollution) | Standard |

### Frontend Packages

| Package | Upgrade Risk | Production Impact | Testing Required |
|---------|-------------|-------------------|------------------|
| glob | LOW | Low (dev only) | Minimal |
| jws | LOW | Medium (if JWT used) | Standard |
| esbuild | MEDIUM | Low (dev only) | Build verification |
| vite | LOW | Low (dev only) | Build verification |
| vitest | HIGH | None (dev only) | Extensive |

---

## Verification Checklist

After applying updates, verify:

### Backend
- [ ] `npm audit` shows 0 vulnerabilities
- [ ] `npm test` passes
- [ ] `npm run dev` starts successfully
- [ ] API endpoints respond correctly
- [ ] Database operations work

### Frontend
- [ ] `npm audit` shows 0 vulnerabilities
- [ ] `npm test` passes
- [ ] `npm run dev` starts successfully
- [ ] `npm run build` completes without errors
- [ ] Application loads in browser
- [ ] All features work as expected

---

## References

### Security Advisories
- [GHSA-43fc-jf86-j433](https://github.com/advisories/GHSA-43fc-jf86-j433) - Axios DoS
- [GHSA-6rw7-vpxm-498p](https://github.com/advisories/GHSA-6rw7-vpxm-498p) - qs DoS
- [GHSA-mh29-5h37-fv8m](https://github.com/advisories/GHSA-mh29-5h37-fv8m) - js-yaml prototype pollution
- [GHSA-5j98-mcp5-4vw2](https://github.com/advisories/GHSA-5j98-mcp5-4vw2) - glob command injection
- [GHSA-869p-cjfg-cm3x](https://github.com/advisories/GHSA-869p-cjfg-cm3x) - jws HMAC bypass
- [GHSA-67mh-4wv8-2f99](https://github.com/advisories/GHSA-67mh-4wv8-2f99) - esbuild dev server

### Migration Documentation
- [js-yaml v3 to v4 Migration Guide](https://github.com/nodeca/js-yaml/blob/master/migrate_v3_to_v4.md)
- [Vite Migration Guide](https://github.com/vitejs/vite/blob/main/docs/guide/migration.md)
- [Vitest Migration Guide](https://github.com/vitest-dev/vitest/blob/main/docs/guide/migration.md)

### Related Project Files
- [`backend/package.json`](backend/package.json)
- [`frontend/package.json`](frontend/package.json)
- [`frontend/vite.config.ts`](frontend/vite.config.ts)
- [`frontend/vitest.config.ts`](frontend/vitest.config.ts)
