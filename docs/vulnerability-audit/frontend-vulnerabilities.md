# Frontend Vulnerability Audit Report

**Audit Date:** 2026-02-11  
**Location:** `/home/pippo/tev2/frontend`  
**Total Dependencies:** 926 (225 prod, 701 dev, 99 optional, 4 peer)

---

## Executive Summary

| Metric | Count |
|--------|-------|
| **Total Vulnerabilities** | 8 |
| Critical | 0 |
| High | 2 |
| Moderate | 6 |
| Low | 0 |

### Quick Fix Summary
- **2 vulnerabilities** can be fixed with `npm audit fix` (non-breaking)
- **6 vulnerabilities** require `npm audit fix --force` (breaking changes - major version upgrade of vitest)

---

## Vulnerability Summary Table

| Package | Severity | CVE/Advisory | Current Version | Fixed Version | Breaking Change |
|---------|----------|--------------|-----------------|---------------|-----------------|
| glob | High | GHSA-5j98-mcp5-4vw2 | 10.2.0 - 10.4.5 | >=10.5.0 | No |
| jws | High | GHSA-869p-cjfg-cm3x | 4.0.0 | !=4.0.0 | No |
| esbuild | Moderate | GHSA-67mh-4wv8-2f99 | <=0.24.2 | >0.24.2 | Yes (via vitest) |
| vite | Moderate | (via esbuild) | 0.11.0 - 6.1.6 | >6.1.6 | Yes (via vitest) |
| vite-node | Moderate | (via vite) | <=2.2.0-beta.2 | >2.2.0-beta.2 | Yes (via vitest) |
| vitest | Moderate | (via vite, vite-node, @vitest/ui) | Multiple ranges | 4.0.18 | Yes |
| @vitest/coverage-v8 | Moderate | (via vitest) | <=2.2.0-beta.2 | 4.0.18 | Yes |
| @vitest/ui | Moderate | (via vitest) | <=0.0.122 \|\| 0.31.0 - 2.2.0-beta.2 | 4.0.18 | Yes |

---

## Detailed Vulnerability Breakdown

### 1. glob (High Severity)

**Advisory:** [GHSA-5j98-mcp5-4vw2](https://github.com/advisories/GHSA-5j98-mcp5-4vw2)  
**Title:** glob CLI: Command injection via -c/--cmd executes matches with shell:true  
**CWE:** CWE-78 (OS Command Injection)  
**CVSS Score:** 7.5 (High)  
**Vector:** CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H

**Affected Versions:** 10.2.0 - 10.4.5  
**Fixed Version:** >=10.5.0  
**Direct Dependency:** No  
**Fix Available:** Yes, via `npm audit fix`

**Description:**  
The glob package has a command injection vulnerability in its CLI when using the `-c` or `--cmd` flags. The command executes matches with `shell:true`, which can allow an attacker to inject arbitrary commands.

**Dependency Chain:**  
This is an indirect dependency in the frontend.

**Recommendation:**  
Run `npm audit fix` to update glob to version 10.5.0 or higher.

---

### 2. jws (High Severity)

**Advisory:** [GHSA-869p-cjfg-cm3x](https://github.com/advisories/GHSA-869p-cjfg-cm3x)  
**Title:** auth0/node-jws Improperly Verifies HMAC Signature  
**CWE:** CWE-347 (Improper Verification of Cryptographic Signature)  
**CVSS Score:** 7.5 (High)  
**Vector:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N

**Affected Version:** 4.0.0 (exact version)  
**Fixed Version:** Any version other than 4.0.0  
**Direct Dependency:** No  
**Fix Available:** Yes, via `npm audit fix`

**Description:**  
The jws package version 4.0.0 has a vulnerability where it improperly verifies HMAC signatures. This could allow an attacker to forge tokens or bypass signature verification.

**Dependency Chain:**  
This is an indirect dependency, likely used by a JWT-related package.

**Recommendation:**  
Run `npm audit fix` to update jws to a patched version.

---

### 3. esbuild (Moderate Severity)

**Advisory:** [GHSA-67mh-4wv8-2f99](https://github.com/advisories/GHSA-67mh-4wv8-2f99)  
**Title:** esbuild enables any website to send any requests to the development server and read the response  
**CWE:** CWE-346 (Origin Validation Error)  
**CVSS Score:** 5.3 (Moderate)  
**Vector:** CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N

**Affected Versions:** <=0.24.2  
**Fixed Version:** >0.24.2  
**Direct Dependency:** No  
**Fix Available:** Yes, via `npm audit fix --force` (breaking change)

**Description:**  
esbuild's development server allows any website to send requests to it and read responses. This is a development-time vulnerability that could expose source code or other sensitive information if a developer visits a malicious website while the dev server is running.

**Dependency Chain:**  
```
vitest → vite → esbuild
```

**Recommendation:**  
Update vitest to version 4.0.18, which will bring in updated versions of vite and esbuild. This is a breaking change requiring `npm audit fix --force`.

---

### 4. vite (Moderate Severity)

**Advisory:** Inherited from esbuild  
**Affected Versions:** 0.11.0 - 6.1.6  
**Fixed Version:** >6.1.6  
**Direct Dependency:** No  
**Fix Available:** Yes, via `npm audit fix --force` (breaking change)

**Description:**  
vite is affected through its dependency on the vulnerable esbuild version.

**Dependency Chain:**  
```
vitest → vite → esbuild
```

**Recommendation:**  
Update vitest to version 4.0.18 to get the patched vite version.

---

### 5. vite-node (Moderate Severity)

**Advisory:** Inherited from vite  
**Affected Versions:** <=2.2.0-beta.2  
**Fixed Version:** >2.2.0-beta.2  
**Direct Dependency:** No  
**Fix Available:** Yes, via `npm audit fix --force` (breaking change)

**Description:**  
vite-node is affected through its dependency on vite, which depends on vulnerable esbuild.

**Dependency Chain:**  
```
vitest → vite-node → vite → esbuild
```

**Recommendation:**  
Update vitest to version 4.0.18.

---

### 6. vitest (Moderate Severity)

**Advisory:** Inherited from multiple dependencies  
**Affected Versions:** 
- 0.0.1 - 0.0.12
- 0.0.29 - 0.0.122
- 0.3.3 - 2.2.0-beta.2
- 4.0.0-beta.1 - 4.0.0-beta.14

**Fixed Version:** 4.0.18  
**Direct Dependency:** Yes  
**Fix Available:** Yes, via `npm audit fix --force` (breaking change)

**Description:**  
vitest is affected through multiple dependency chains involving @vitest/ui, vite, and vite-node, all of which ultimately trace back to the esbuild vulnerability.

**Dependency Chains:**
```
vitest → @vitest/ui → (circular)
vitest → vite → esbuild
vitest → vite-node → vite → esbuild
```

**Recommendation:**  
Update vitest to version 4.0.18. This is a major version upgrade and may require code changes.

---

### 7. @vitest/coverage-v8 (Moderate Severity)

**Advisory:** Inherited from vitest  
**Affected Versions:** <=2.2.0-beta.2  
**Fixed Version:** 4.0.18  
**Direct Dependency:** Yes  
**Fix Available:** Yes, via `npm audit fix --force` (breaking change)

**Description:**  
This package is affected through its dependency on vitest.

**Dependency Chain:**  
```
@vitest/coverage-v8 → vitest → (vulnerable chain)
```

**Recommendation:**  
Update to version 4.0.18 along with vitest.

---

### 8. @vitest/ui (Moderate Severity)

**Advisory:** Inherited from vitest  
**Affected Versions:** 
- <=0.0.122
- 0.31.0 - 2.2.0-beta.2

**Fixed Version:** 4.0.18  
**Direct Dependency:** Yes  
**Fix Available:** Yes, via `npm audit fix --force` (breaking change)

**Description:**  
This package is affected through its dependency on vitest and also creates a circular dependency issue.

**Dependency Chain:**  
```
@vitest/ui → vitest → (vulnerable chain)
vitest → @vitest/ui (circular)
```

**Recommendation:**  
Update to version 4.0.18 along with vitest.

---

## Dependency Tree Visualization

```
vitest (direct, vulnerable)
├── @vitest/ui (direct, vulnerable)
│   └── vitest (circular)
├── @vitest/coverage-v8 (direct, vulnerable)
│   └── vitest
├── vite (vulnerable via esbuild)
│   └── esbuild (vulnerable)
└── vite-node (vulnerable)
    └── vite (vulnerable)
        └── esbuild (vulnerable)

glob (indirect, vulnerable) - standalone

jws (indirect, vulnerable) - standalone
```

---

## Remediation Plan

### Phase 1: Non-Breaking Fixes (Immediate)

Run the following command to fix glob and jws vulnerabilities:

```bash
cd /home/pippo/tev2/frontend
npm audit fix
```

This will update:
- glob to >=10.5.0
- jws to a version other than 4.0.0

### Phase 2: Breaking Changes (Requires Testing)

The vitest ecosystem vulnerabilities require a major version upgrade. Before proceeding:

1. **Review Breaking Changes:** Check vitest 4.x changelog for breaking changes
2. **Update Test Configuration:** May need to update `vitest.config.ts`
3. **Test Suite Compatibility:** Ensure all existing tests work with new version

Run the following command after testing:

```bash
cd /home/pippo/tev2/frontend
npm audit fix --force
```

This will update:
- vitest to 4.0.18
- @vitest/coverage-v8 to 4.0.18
- @vitest/ui to 4.0.18
- vite to a patched version
- vite-node to a patched version
- esbuild to a patched version

---

## Risk Assessment

### High Severity Issues

| Package | Risk | Production Impact |
|---------|------|-------------------|
| glob | Command injection in CLI | Low - development only |
| jws | HMAC signature bypass | Medium - depends on usage |

### Moderate Severity Issues

| Package | Risk | Production Impact |
|---------|------|-------------------|
| esbuild | Dev server data exposure | Low - development only |
| vite | Inherited from esbuild | Low - development only |
| vite-node | Inherited from vite | Low - development only |
| vitest | Inherited from dependencies | Low - development only |
| @vitest/coverage-v8 | Inherited from vitest | Low - development only |
| @vitest/ui | Inherited from vitest | Low - development only |

**Note:** Most vulnerabilities are in development dependencies and do not affect production builds. However, the jws vulnerability could be a concern if JWT tokens are used in the frontend.

---

## Verification Steps

After applying fixes, verify with:

```bash
cd /home/pippo/tev2/frontend
npm audit
```

Expected result: 0 vulnerabilities

---

## References

- [GHSA-5j98-mcp5-4vw2](https://github.com/advisories/GHSA-5j98-mcp5-4vw2) - glob command injection
- [GHSA-869p-cjfg-cm3x](https://github.com/advisories/GHSA-869p-cjfg-cm3x) - jws HMAC signature bypass
- [GHSA-67mh-4wv8-2f99](https://github.com/advisories/GHSA-67mh-4wv8-2f99) - esbuild dev server vulnerability
