# Backend Vulnerability Audit Report

**Audit Date:** 2026-02-11  
**Audit Tool:** npm audit  
**Backend Location:** `/home/pippo/tev2/backend`  
**Total Dependencies:** 926 (225 prod, 701 dev, 99 optional, 4 peer)

---

## Executive Summary

| Metric | Count |
|--------|-------|
| **Total Vulnerabilities** | 5 |
| Critical | 0 |
| High | 4 |
| Moderate | 1 |
| Low | 0 |
| Info | 0 |

**All vulnerabilities have fixes available via `npm audit fix`.**

---

## Vulnerability Summary Table

| Package | Severity | Current Version | Vulnerable Range | Fixed Version | CVE/GHSA |
|---------|----------|-----------------|------------------|---------------|----------|
| axios | High | 1.13.3 | <=1.13.4 | >1.13.4 | GHSA-43fc-jf86-j433 |
| express | High | 4.21.2 | 4.0.0-rc1 - 4.21.2 | >4.21.2 | GHSA-6rw7-vpxm-498p (via qs) |
| body-parser | High | 1.20.3 | <=1.20.3 | >1.20.3 | GHSA-6rw7-vpxm-498p (via qs) |
| qs | High | 6.13.0 / 6.14.0 | <6.14.1 | >=6.14.1 | GHSA-6rw7-vpxm-498p |
| js-yaml | Moderate | 3.14.1 | <3.14.2 | >=3.14.2 | GHSA-mh29-5h37-fv8m |

---

## Detailed Vulnerability Breakdown

### 1. axios (HIGH)

**Current Version:** 1.13.3  
**Vulnerable Range:** <=1.13.4  
**Direct Dependency:** Yes

#### Vulnerability Details
- **Title:** Axios is Vulnerable to Denial of Service via `__proto__` Key in mergeConfig
- **GHSA ID:** GHSA-43fc-jf86-j433
- **URL:** https://github.com/advisories/GHSA-43fc-jf86-j433
- **CWE:** CWE-754 (Improper Check for Unusual or Exceptional Conditions)
- **CVSS Score:** 7.5 (High)
- **CVSS Vector:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

#### Description
Axios is vulnerable to a Denial of Service (DoS) attack when processing untrusted input. The vulnerability exists in the `mergeConfig` function where the `__proto__` property key can be exploited.

#### Impact
- Network-accessible attack vector
- No privileges required
- No user interaction needed
- Affects availability only (no confidentiality or integrity impact)

#### Fix
Update axios to version >1.13.4.

---

### 2. qs (HIGH)

**Current Version:** 6.13.0 (express), 6.14.0 (other)  
**Vulnerable Range:** <6.14.1  
**Direct Dependency:** No (transitive via express, body-parser)

#### Vulnerability Details
- **Title:** qs's arrayLimit bypass in its bracket notation allows DoS via memory exhaustion
- **GHSA ID:** GHSA-6rw7-vpxm-498p
- **URL:** https://github.com/advisories/GHSA-6rw7-vpxm-498p
- **CWE:** CWE-20 (Improper Input Validation)
- **CVSS Score:** 7.5 (High)
- **CVSS Vector:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

#### Description
The `qs` library's `arrayLimit` bypass in its bracket notation allows an attacker to cause Denial of Service through memory exhaustion. This affects applications that parse query strings from untrusted sources.

#### Impact
- Network-accessible attack vector
- No privileges required
- No user interaction needed
- Affects availability only

#### Dependency Chain
```
express@4.21.2
├── body-parser@1.20.3
│   └── qs@6.13.0 (vulnerable)
└── qs@6.13.0 (vulnerable)
```

#### Fix
Update qs to version >=6.14.1. This will be resolved by updating express.

---

### 3. express (HIGH)

**Current Version:** 4.21.2  
**Vulnerable Range:** 4.0.0-rc1 - 4.21.2  
**Direct Dependency:** Yes

#### Vulnerability Details
- **Title:** Inherited vulnerability via qs and body-parser dependencies
- **GHSA ID:** GHSA-6rw7-vpxm-498p (via qs)
- **URL:** https://github.com/advisories/GHSA-6rw7-vpxm-498p

#### Description
Express is vulnerable due to its dependencies on `qs` and `body-parser`, both of which are affected by the qs vulnerability described above.

#### Dependency Chain
```
express@4.21.2 (vulnerable)
├── body-parser@1.20.3 (vulnerable via qs)
│   └── qs@6.13.0 (vulnerable)
└── qs@6.13.0 (vulnerable)
```

#### Fix
Update express to version >4.21.2 when available, or run `npm audit fix` to update transitive dependencies.

---

### 4. body-parser (HIGH)

**Current Version:** 1.20.3  
**Vulnerable Range:** <=1.20.3 || 2.0.0-beta.1 - 2.0.2  
**Direct Dependency:** No (transitive via express)

#### Vulnerability Details
- **Title:** Inherited vulnerability via qs dependency
- **GHSA ID:** GHSA-6rw7-vpxm-498p (via qs)

#### Description
body-parser is vulnerable due to its dependency on the vulnerable version of `qs`. This middleware is used by Express for parsing request bodies.

#### Fix
Update body-parser to version >1.20.3. This will be resolved by updating express.

---

### 5. js-yaml (MODERATE)

**Current Version:** 3.14.1  
**Vulnerable Range:** <3.14.2  
**Direct Dependency:** No (transitive)

#### Vulnerability Details
- **Title:** js-yaml has prototype pollution in merge (<<)
- **GHSA ID:** GHSA-mh29-5h37-fv8m
- **URL:** https://github.com/advisories/GHSA-mh29-5h37-fv8m
- **CWE:** CWE-1321 (Improperly Controlled Modification of Object Prototype Attributes)
- **CVSS Score:** 5.3 (Moderate)
- **CVSS Vector:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N

#### Description
js-yaml is vulnerable to prototype pollution through the merge (<<) feature in YAML parsing. This could allow an attacker to modify the prototype of base objects.

#### Impact
- Network-accessible attack vector
- No privileges required
- No user interaction needed
- Affects integrity only (low impact)

#### Fix
Update js-yaml to version >=3.14.2.

---

## Dependency Tree Analysis

### Direct Dependencies Affected
1. **axios** - Direct dependency, needs update
2. **express** - Direct dependency, needs update (or transitive fix)

### Transitive Dependencies Affected
1. **qs** - Used by express and body-parser
2. **body-parser** - Used by express
3. **js-yaml** - Transitive dependency (likely via a dev dependency)

---

## Recommended Actions

### Immediate Actions (All fixes available)

Run the following command to apply all available fixes:

```bash
cd /home/pippo/tev2/backend
npm audit fix
```

If some vulnerabilities persist after `npm audit fix`, you may need:

```bash
npm audit fix --force
```

**⚠️ Warning:** `--force` may introduce breaking changes. Review changes carefully.

### Manual Review Recommended

1. **axios**: Update to latest stable version
   ```bash
   npm install axios@latest
   ```

2. **express**: Check for updates that include qs fixes
   ```bash
   npm install express@latest
   ```

3. **js-yaml**: If directly referenced, update manually
   ```bash
   npm install js-yaml@latest
   ```

---

## Testing Recommendations

After applying fixes:

1. Run test suite to ensure no breaking changes
   ```bash
   npm test
   ```

2. Verify application starts correctly
   ```bash
   npm run dev
   ```

3. Re-run audit to confirm all vulnerabilities are resolved
   ```bash
   npm audit
   ```

---

## References

- [GHSA-43fc-jf86-j433](https://github.com/advisories/GHSA-43fc-jf86-j433) - Axios DoS vulnerability
- [GHSA-6rw7-vpxm-498p](https://github.com/advisories/GHSA-6rw7-vpxm-498p) - qs DoS vulnerability
- [GHSA-mh29-5h37-fv8m](https://github.com/advisories/GHSA-mh29-5h37-fv8m) - js-yaml prototype pollution

---

## Appendix: Raw npm audit --json Output

```json
{
  "auditReportVersion": 2,
  "vulnerabilities": {
    "axios": {
      "name": "axios",
      "severity": "high",
      "isDirect": true,
      "via": [
        {
          "source": 1113092,
          "name": "axios",
          "dependency": "axios",
          "title": "Axios is Vulnerable to Denial of Service via __proto__ Key in mergeConfig",
          "url": "https://github.com/advisories/GHSA-43fc-jf86-j433",
          "severity": "high",
          "cwe": ["CWE-754"],
          "cvss": {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
          },
          "range": "<=1.13.4"
        }
      ],
      "effects": [],
      "range": "<=1.13.4",
      "nodes": ["node_modules/axios"],
      "fixAvailable": true
    },
    "body-parser": {
      "name": "body-parser",
      "severity": "high",
      "isDirect": false,
      "via": ["qs"],
      "effects": ["express"],
      "range": "<=1.20.3 || 2.0.0-beta.1 - 2.0.2",
      "nodes": ["backend/node_modules/body-parser"],
      "fixAvailable": true
    },
    "express": {
      "name": "express",
      "severity": "high",
      "isDirect": true,
      "via": ["body-parser", "qs"],
      "effects": [],
      "range": "2.5.8 - 2.5.11 || 3.2.1 - 3.2.3 || 4.0.0-rc1 - 4.21.2 || 5.0.0-alpha.1 - 5.0.1",
      "nodes": ["backend/node_modules/express"],
      "fixAvailable": true
    },
    "js-yaml": {
      "name": "js-yaml",
      "severity": "moderate",
      "isDirect": false,
      "via": [
        {
          "source": 1112714,
          "name": "js-yaml",
          "dependency": "js-yaml",
          "title": "js-yaml has prototype pollution in merge (<<)",
          "url": "https://github.com/advisories/GHSA-mh29-5h37-fv8m",
          "severity": "moderate",
          "cwe": ["CWE-1321"],
          "cvss": {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N"
          },
          "range": "<3.14.2"
        }
      ],
      "effects": [],
      "range": "<3.14.2",
      "nodes": ["node_modules/js-yaml"],
      "fixAvailable": true
    },
    "qs": {
      "name": "qs",
      "severity": "high",
      "isDirect": false,
      "via": [
        {
          "source": 1113132,
          "name": "qs",
          "dependency": "qs",
          "title": "qs's arrayLimit bypass in its bracket notation allows DoS via memory exhaustion",
          "url": "https://github.com/advisories/GHSA-6rw7-vpxm-498p",
          "severity": "high",
          "cwe": ["CWE-20"],
          "cvss": {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
          },
          "range": "<6.14.1"
        }
      ],
      "effects": ["body-parser", "express"],
      "range": "<6.14.1",
      "nodes": ["backend/node_modules/qs", "node_modules/qs"],
      "fixAvailable": true
    }
  },
  "metadata": {
    "vulnerabilities": {
      "info": 0,
      "low": 0,
      "moderate": 1,
      "high": 4,
      "critical": 0,
      "total": 5
    },
    "dependencies": {
      "prod": 225,
      "dev": 701,
      "optional": 99,
      "peer": 4,
      "peerOptional": 0,
      "total": 926
    }
  }
}
```
